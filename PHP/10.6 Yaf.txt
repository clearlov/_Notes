/**
 * http://php.net/manual/en/book.yaf.php
 */

|~ Yaf Constant ~|
YAF_VERSION(Yaf\VERSION)	Yaf框架的三位版本信息
YAF_ENVIRON(Yaf\ENVIRON	Yaf的环境常量, 指明了要读取的配置的节, 默认的是product
YAF_ERR_STARTUP_FAILED(Yaf\ERR\STARTUP_FAILED)	Yaf的错误代码常量, 表示启动失败, 值为512
YAF_ERR_ROUTE_FAILED(Yaf\ERR\ROUTE_FAILED)	Yaf的错误代码常量, 表示路由失败, 值为513
YAF_ERR_DISPATCH_FAILED(Yaf\ERR\DISPATCH_FAILED)	Yaf的错误代码常量, 表示分发失败, 值为514
YAF_ERR_NOTFOUND_MODULE(Yaf\ERR\NOTFOUD\MODULE)	Yaf的错误代码常量, 表示找不到指定的模块, 值为515
YAF_ERR_NOTFOUND_CONTROLLER(Yaf\ERR\NOTFOUD\CONTROLLER)	Yaf的错误代码常量, 表示找不到指定的Controller, 值为516
YAF_ERR_NOTFOUND_ACTION(Yaf\ERR\NOTFOUD\ACTION)	Yaf的错误代码常量, 表示找不到指定的Action, 值为517
YAF_ERR_NOTFOUND_VIEW(Yaf\ERR\NOTFOUD\VIEW)	Yaf的错误代码常量, 表示找不到指定的视图文件, 值为518
YAF_ERR_CALL_FAILED(Yaf\ERR\CALL_FAILED)	Yaf的错误代码常量, 表示调用失败, 值为519
YAF_ERR_AUTOLOAD_FAILED(Yaf\ERR\AUTOLOAD_FAILED)	Yaf的错误代码常量, 表示自动加载类失败, 值为520
YAF_ERR_TYPE_ERROR(Yaf\ERR\TYPE_ERROR)	Yaf的错误代码常量, 表示关键逻辑的参数错误, 值为521


|~ load application.ini ~|
/***********  public/index.php *******************/
<?php
define ('APP_PATH', realpath(dirname(__FILE__) . '/../'));
$app = new Yaf_Application(APP_PATH . '/conf/application.ini');
$app->run();
/******************************************************/

/***********  conf/application.ini ***************/
**  Yaf'll load configures into memory, it's not script
[product]
application.directory= [ = APP_PATH '/application']  // APP_PATH is defined in public/index.php

// Uses AD to replace application.direactory below 

application.ext=[ ?=php ]       // extension of PHP, php,php3..
application.view.ext= [ ?=phtml ]    // ext of view files.
application.bootstrap=[ ?=AD + Bootstrap.php ]   // abstract path of Yaf_Application::bootstrap
application.library= [ ?= AD + '/library' ]
application.baseUrl= [ ?=NULL ]
application.dispatcher.throwException= [ ?=TRUE ]

/* throw Exception to ErrorController(extends Yaf_Controller_Abstract) */
application.dispatcher.catchException= [ ?=FALSE ]  

application.dispatcher.defaultModule= [ ?=index ]
application.dispatcher.defaultController= [ ?=index ]
application.dispatcher.defaultAction= [ ?=index ]

application.modules= [ ?=Index ]   // e.g. 'Index, Module' or 'Index, Test' 



// http://www.laruence.com/manual/yaf.config.optional.html






|~ Autoload ~|
Yaf'll register a Autoloader by SPL. You can change Controller/Model/Plugin be
 a prefix or suffix in php.ini (yaf.name_suffix)
    Controller    ==>    controllers/     or    modules/[ MODULE ]/controllers/
    Model         ==>    models/
    Plugin        ==>    plugins/
You can change global class path by changing yaf.library in php.ini, and change
 local class's prefix by Yaf_Loader->registerLocalNamespace()
http://www.laruence.com/manual/yaf.ini.html
--------------------------------------------------------------------------------
*(PHP_INI_ALL)   $(PHP_INI_SYSTEM)
yaf.environ			?=product  	*   sector that the yaf reads (e.g. in conf/application.ini)
yaf.library			?			*	path of global library
yaf.cache_config	?=0			$	
yaf.name_suffix		?=1			*	
yaf.name_separator	?=""		*	
yaf.forward_limit	?=5			*	
yaf.use_namespace	?=0			$	
yaf.use_spl_autoload?=0			*
--------------------------------------------------------------------------------




|- Yaf uses underline to split menu (like /),  -|
e.g.    
    $loader =  Yaf_Loader::Instance();
    $loader->registerLocalNamespace(array('Foo', 'Local'));\
	/*	traces [ yaf.library in php.ini ]/Foo/Vince/Well.php  */
	$local_class = new Foo_Vince_Well();
	
|+ Bootstrap +|
In application/controllers/xx, we can use Yaf_Application::bootstrap before Yaf_Application::run,
e.g.
    $app = new Yaf_Application('conf.ini');
    $app
     ->bootstrap()                       // optional, runs class Bootstrap in application.bootstrap
     ->run();
|- Bootstrap.php , in application.bootstrap  -|
Bootstrap inherits Yaf_Bootstrap_Abstract, and Yaf_Application::bootstrap will run every methods start with _init one by one
NOTE:every methods start with _init can accpet a Yaf_Dispatcher instance to be its paramter. http://www.laruence.com/manual/yaf.class.dispatcher.html

e.g.
class Bootstrap extends Yaf_Bootstrap_Abstract{
    public function _initConfig(){
    }

    public function _initDefaultName(Yaf_Dispatcher $dispacher){
    }
}

|- register plugin for Bootstrap  -|
http://www.laruence.com/manual/yaf.plugin.define.html
Inherits Yaf_Plugin_Abstract, and transfer Yaf_Request_Abstract / Yaf_Response_Abstract paramters

class userPlugin extends Yaf_Plugin_Abstract{
    public function routerStartup(Yaf_Request_Abstract $rq, Yaf_Response_Abstract $rp){
    }

}

|~ Routes ~|
/**
 * http://php.net/manual/en/class.yaf-router.php
 */
 
|-   -|
/*
http://www.laruence.com/manual/yaf.routes.static.html

?r=abash/baas/cable/vacate
if   Yaf.modules="Index,Abash"  in .ini
	'module'		=>	'abash',
	'controller'	=>	'baas',
	'action'			=>	'cable',
	'params'		=>	[vacate=>NULL,]
else
	'module'		=>	'[ DEFAULT_YAF_MODULES_IN_INI ]',
	'controller'	=>	'abash',
	'action'			=>	'baas',
	'params'		=>	['cable'=>vacate]
*/


class Bootstrap extends Yaf_Bootstrap_Abstract{
	public function _initRoute(Yaf_Dipatcher $dpt){
		$router = Yaf_Dipatcher::getInstatnce()->getRouter();
		$route = new Yaf_Route_Supervar('r');
		$router->addRoute('supervar', $route);
	}
}



|~ Error/Exception ~|
/**
 * http://php.net/manual/en/class.yaf-exception.php
 */
configure application.dispatcher.catchException=true or Yaf_Dispatcher::catchException(true)
catch it by  Yaf_Controller_Abstract::getRequest()->getException()  or  Yaf_Controller_Abstract::getRequest()->getParam('exception')

class ErrorController extends Yaf_Controller_Abstract{

	public function errorAction($exception){
		$error_code = $exception->getCode();
		
	}
/*	
	public function errorAction(){
		$exception = $this->getRequest()->getException();
		try{
		} catch (Yaf_Exception_LoadFailed $e){
		
		} catch (Yaf_Exception $e){
		
		}
	}
	
*/	
	
	
}


|~ Plugin ~|
Yaf_Plugin_Abstract  --> Bootstrap --> Yaf_Dispatcher::registerPlugin
--------------------------------------------------------------------------------
routerStartup
routerShutdown
dispatchLoopStartup
preDispatch
postDispatch
dispatchLoopShutdown
--------------------------------------------------------------------------------

class LayoutPlugin extends Yaf_Plugin_Abstract{
	
	public function __contruct(){
	
	}
	
	public function routerStartup(Yaf_Request_Abstract $rqst , Yaf_Response_Abstract $rsps){
	}
	public function routerShutdown(Yaf_Request_Abstract $rqst , Yaf_Response_Abstract $rsps){
	}
	public function dispatchLoopStartup(Yaf_Request_Abstract $rqst , Yaf_Response_Abstract $rsps){
	}
	public function preDispatch(Yaf_Request_Abstract $rqst , Yaf_Response_Abstract $rsps){
		/* http://php.net/manual/en/yaf-response-abstract.appendbody.php */
		$content = $rsps->getBody();
		$rsps->clearBody();
		/* http://php.net/manual/en/class.yaf-view-simple.php */
		$view = new Yaf_View_Simple();
		$view->assign();
		$rsps->setBody();
		
	}
	public function postDispatch(Yaf_Request_Abstract $rqst , Yaf_Response_Abstract $rsps){
	}
	public function dispatchLoopShutdown(Yaf_Request_Abstract $rqst , Yaf_Response_Abstract $rsps){
	}
}

class Bootstrap extends Yaf_Bootstrap_Abstract{
	public function _initPlugin(Yaf_Dispatcher $dspt){
		$layout = new LayoutPlugin();
		$dspt->registerPlugin($layout);
	}
}

class IndexController extends Yaf_Controller_Abstract{
	public function indexAction(){
	
	}
}






















